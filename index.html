<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Imposter Game</title>

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    height: 100vh;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: radial-gradient(circle at top, #1a2a6c, #000428);
    display: flex;
    justify-content: center;
    align-items: center;
    color: white;
}

.container {
    width: 360px;
    text-align: center;
}

.hidden { display: none; }

h1 {
    font-size: 28px;
    margin-bottom: 15px;
}

.card {
    background: rgba(255,255,255,0.12);
    backdrop-filter: blur(18px);
    border-radius: 24px;
    padding: 30px 25px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.6);
    animation: popIn 0.4s ease;
}

@keyframes popIn {
    from { opacity: 0; transform: scale(0.9); }
    to { opacity: 1; transform: scale(1); }
}

input {
    width: 90%;
    padding: 12px;
    font-size: 16px;
    border-radius: 12px;
    border: none;
    margin-bottom: 10px;
}

button {
    padding: 14px 32px;
    font-size: 16px;
    border-radius: 30px;
    border: none;
    cursor: pointer;
    transition: 0.2s;
    margin-top: 10px;
}

button:active { transform: scale(0.95); }

.start-btn {
    background: linear-gradient(135deg, #00f260, #0575e6);
    color: black;
}

.skip-btn {
    background: transparent;
    color: #ccc;
    border: 1px solid #555;
}

.reveal-btn {
    background: linear-gradient(135deg, #f7971e, #ffd200);
    color: black;
}

.next-btn {
    background: linear-gradient(135deg, #00c6ff, #0072ff);
    color: black;
}

.end-btn {
    background: linear-gradient(135deg, #ff416c, #ff4b2b);
    color: white;
    margin-top: 20px;
}

.player-title {
    font-size: 22px;
    margin-bottom: 10px;
}

.info {
    opacity: 0.7;
    margin-bottom: 20px;
}

.name {
    font-size: 32px;
    font-weight: 700;
    color: #ffe259;
    margin: 25px 0;
}
</style>
</head>

<body>

<div class="container">
<h1>üïµÔ∏è Imposter Game</h1>

<!-- STEP 1: PLAYER COUNT -->
<div id="setup" class="card">
    <div>Players (2‚Äì8)</div><br>
    <input type="number" id="players" min="2" max="8" value="4">
    <button class="start-btn" onclick="goToNames()">Next</button>
</div>

<!-- STEP 2: OPTIONAL PLAYER NAMES -->
<div id="nameSetup" class="card hidden">
    <div>Enter Player Names (Optional)</div><br>
    <div id="nameInputs"></div>
    <button class="start-btn" onclick="saveNames()">Start Round</button>
    <button class="skip-btn" onclick="skipNames()">Skip</button>
</div>

<!-- GAME -->
<div id="game" class="hidden">
    <div class="card">
        <div class="player-title" id="playerTitle"></div>
        <div class="info" id="infoText">Pass the phone and tap Reveal</div>

        <div class="name hidden" id="nameText"></div>

        <button class="reveal-btn" id="revealBtn" onclick="reveal()">Reveal</button>
        <button class="next-btn hidden" id="nextBtn" onclick="nextPlayer()">Next Player</button>
        <button class="end-btn hidden" id="endBtn" onclick="endRound()">End Round</button>
    </div>
</div>

<!-- END SCREEN -->
<div id="endScreen" class="hidden">
    <div class="card">
        <div class="player-title">Next Round Ready üéâ</div>
        <button class="start-btn" onclick="nextRound()">Start Next Round</button>
    </div>
</div>
</div>

<script>
const secretNames = [
    "suma","ram","sandhya","vishu","seethu",
    "pradeep","vaishu","veena","vasu","ammu"
];

let totalPlayers = 0;
let playerNames = [];
let assignments = [];
let currentPlayer = 0;

// Anti-repeat memory
let lastImposter = -1;
let lastCommonName = "";
let lastImposterName = "";

/* ---------- SETUP ---------- */
function goToNames() {
    totalPlayers = document.getElementById("players").value;
    const box = document.getElementById("nameInputs");
    box.innerHTML = "";

    for (let i = 0; i < totalPlayers; i++) {
        box.innerHTML += `<input placeholder="Player ${i + 1} (optional)">`;
    }

    document.getElementById("setup").classList.add("hidden");
    document.getElementById("nameSetup").classList.remove("hidden");
}

function skipNames() {
    playerNames = Array.from(
        { length: totalPlayers },
        (_, i) => `Player ${i + 1}`
    );
    startRound();
}

function saveNames() {
    const inputs = document.querySelectorAll("#nameInputs input");
    playerNames = [];

    for (let i = 0; i < totalPlayers; i++) {
        playerNames.push(inputs[i].value || `Player ${i + 1}`);
    }
    startRound();
}

/* ---------- ROUND LOGIC ---------- */
function startRound() {
    assignments = [];
    currentPlayer = 0;

    let imposter;
    do {
        imposter = Math.floor(Math.random() * totalPlayers);
    } while (imposter === lastImposter && totalPlayers > 2);

    lastImposter = imposter;

    let commonName;
    do {
        commonName = secretNames[Math.floor(Math.random() * secretNames.length)];
    } while (commonName === lastCommonName);

    let imposterName;
    do {
        imposterName = secretNames[Math.floor(Math.random() * secretNames.length)];
    } while (imposterName === commonName || imposterName === lastImposterName);

    lastCommonName = commonName;
    lastImposterName = imposterName;

    for (let i = 0; i < totalPlayers; i++) {
        assignments.push(i === imposter ? imposterName : commonName);
    }

    document.getElementById("nameSetup").classList.add("hidden");
    document.getElementById("endScreen").classList.add("hidden");
    document.getElementById("game").classList.remove("hidden");

    updateCard();
}

/* ---------- GAME UI ---------- */
function updateCard() {
    document.getElementById("playerTitle").innerText = playerNames[currentPlayer];
    document.getElementById("infoText").classList.remove("hidden");
    document.getElementById("nameText").classList.add("hidden");
    document.getElementById("revealBtn").classList.remove("hidden");
    document.getElementById("nextBtn").classList.add("hidden");
    document.getElementById("endBtn").classList.add("hidden");
}

function reveal() {
    document.getElementById("nameText").innerText = assignments[currentPlayer];
    document.getElementById("nameText").classList.remove("hidden");
    document.getElementById("infoText").classList.add("hidden");
    document.getElementById("revealBtn").classList.add("hidden");

    if (currentPlayer === totalPlayers - 1) {
        document.getElementById("endBtn").classList.remove("hidden");
    } else {
        document.getElementById("nextBtn").classList.remove("hidden");
    }
}

function nextPlayer() {
    currentPlayer++;
    updateCard();
}

function endRound() {
    document.getElementById("game").classList.add("hidden");
    document.getElementById("endScreen").classList.remove("hidden");
}

function nextRound() {
    startRound();
}
</script>

</body>
</html>
