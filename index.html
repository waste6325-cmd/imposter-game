<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport"
content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Imposter Game</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
*{box-sizing:border-box}

body{
 margin:0;min-height:100vh;font-family:'Poppins',sans-serif;
 background:radial-gradient(circle at top,#2d0b59,#0b0016);
 display:flex;justify-content:center;align-items:center;
 color:white;touch-action:manipulation;
}
.container{width:100%;max-width:420px;padding:1rem;text-align:center}
.hidden{display:none}

h1{font-size:2.2rem;margin-bottom:.3rem}
#roundCounter{opacity:.6;margin-bottom:.8rem}

.card{
 background:linear-gradient(145deg,rgba(255,255,255,.18),rgba(255,255,255,.05));
 backdrop-filter:blur(18px);
 border-radius:1.5rem;padding:1.8rem;
 box-shadow:0 25px 50px rgba(0,0,0,.7);
 margin-bottom:1rem;animation:fadeUp .4s ease;
}
@keyframes fadeUp{
 from{opacity:0;transform:translateY(20px) scale(.96)}
 to{opacity:1;transform:none}
}

.player-title{font-size:1.5rem;font-weight:600;margin-bottom:.7rem}
.info{opacity:.7;margin-bottom:1rem}

input{
 width:100%;padding:.85rem;border-radius:.7rem;border:none;
 font-size:1rem;margin-bottom:.6rem;
}

button{
 width:100%;padding:.9rem;border:none;border-radius:.8rem;
 font-size:1rem;font-weight:600;cursor:pointer;
 margin-top:.5rem;transition:.25s;
}
button:active{transform:scale(.96)}

.primary{background:linear-gradient(135deg,#ff6a88,#ff9068);color:#fff}
.secondary{background:transparent;color:#ddd;border:1px solid rgba(255,255,255,.4)}
.gold{background:linear-gradient(135deg,#fbc531,#e1a100);color:#000}
.purple{background:linear-gradient(135deg,#8e44ad,#6c3483);color:#fff}
.red{background:linear-gradient(135deg,#ff416c,#ff4b2b);color:#fff}

.list-item{
 display:flex;gap:.5rem;margin-bottom:.5rem;align-items:center;
}
.list-item span{
 flex:1;background:rgba(255,255,255,.15);
 padding:.5rem;border-radius:.5rem;
}
.list-item button{
 width:auto;padding:.4rem .6rem;font-size:.8rem;
}

.name{
 font-size:1.5rem;font-weight:700;margin:1.2rem 0;
 color:#ffeaa7;
}
.name.imposter{
 color:#ff4b2b;
 text-shadow:0 0 18px rgba(255,75,43,.9);
 animation:pulse 1s infinite;
}
@keyframes pulse{50%{transform:scale(1.12)}}
</style>
</head>

<body>
<div class="container">

<h1>üïµÔ∏è Imposter</h1>
<div id="roundCounter">Round: 1</div>

<!-- START -->
<div id="startChoice" class="card">
 <div class="player-title">Game Settings</div>

 <div class="info">Players (2 ‚Äì 10)</div>
 <input type="number" id="playerCount" min="2" max="10" value="4">

 <div class="info">Imposters</div>
 <input type="number" id="imposterCount" min="1" value="1">

 <button class="primary" onclick="useDefault()">Use Default Names</button>
 <button class="secondary" onclick="showSaved()">Use Saved</button>
 <button class="secondary" onclick="showAdd()">Add New</button>
</div>

<!-- ADD NAMES -->
<div id="addNames" class="card hidden">
 <div class="player-title">Add Names</div>
 <input id="secretInput" placeholder="Enter name">
 <button class="primary" onclick="addSecret()">Add</button>
 <div id="secretList"></div>
 <button class="primary" onclick="askTitle()">Continue</button>
</div>

<!-- SAVE TITLE -->
<div id="saveTitle" class="card hidden">
 <div class="player-title">Save Set</div>
 <input id="setTitle" placeholder="Example: Friends / College">
 <button class="primary" onclick="saveSet()">Save & Continue</button>
 <button class="secondary" onclick="skipSave()">Skip Saving</button>
</div>

<!-- SAVED LIST -->
<div id="savedList" class="card hidden">
 <div class="player-title">Saved Sets</div>
 <div id="savedSets"></div>
 <button class="secondary" onclick="backToStart()">Back</button>
</div>

<!-- GAME -->
<div id="game" class="card hidden">
 <div class="player-title" id="playerTitle"></div>
 <div class="info" id="infoText">Pass phone & tap reveal</div>
 <div class="name hidden" id="nameText"></div>

 <button class="gold" id="revealBtn" onclick="reveal()">Reveal</button>
 <button class="purple hidden" id="nextBtn" onclick="nextPlayer()">Next</button>
</div>

<!-- ROUND END -->
<div id="roundEnd" class="card hidden">
 <div class="player-title">Round Complete üéâ</div>
 <button class="primary" onclick="nextRound()">Next Round</button>
</div>

</div>

<script>
const defaultSecrets=["Suma","Ram","Sandhya","Vishu","Seethu","Pradeep","Vaishu","Veena"];
const storeKey="imposterNameSets";

let secretNames=[],sets={},players=[];
let assignments=[],currentPlayer=0,round=1,lastMainImposter=-1;
let imposterTotal=1;

/* ---------- STORAGE ---------- */
function loadSets(){sets=JSON.parse(localStorage.getItem(storeKey)||"{}")}
function saveSets(){localStorage.setItem(storeKey,JSON.stringify(sets))}

/* ---------- PLAYERS ---------- */
function setupPlayers(){
 const p = Math.min(10, Math.max(2, parseInt(playerCount.value || 4)));
 players=[];
 for(let i=1;i<=p;i++) players.push("Player "+i);

 const maxImp = Math.floor(p/2);
 imposterCount.max = maxImp;
 imposterTotal = Math.min(maxImp, Math.max(1, parseInt(imposterCount.value||1)));
 imposterCount.value = imposterTotal;
}

/* ---------- START ---------- */
function useDefault(){
 setupPlayers();
 secretNames=[...defaultSecrets];
 startGame();
}
function showAdd(){
 setupPlayers();
 startChoice.classList.add("hidden");
 addNames.classList.remove("hidden");
}
function showSaved(){
 setupPlayers();
 loadSets();
 if(Object.keys(sets).length===0) return alert("No saved sets");
 startChoice.classList.add("hidden");
 savedList.classList.remove("hidden");
 renderSaved();
}

/* ---------- ADD & SAVE ---------- */
function addSecret(){
 if(!secretInput.value.trim())return;
 secretNames.push(secretInput.value.trim());
 secretInput.value="";
 renderSecrets();
}
function renderSecrets(){
 secretList.innerHTML="";
 secretNames.forEach((n,i)=>{
  secretList.innerHTML+=`
   <div class="list-item">
    <span>${n}</span>
    <button class="red" onclick="secretNames.splice(${i},1);renderSecrets()">‚úï</button>
   </div>`;
 });
}
function askTitle(){
 if(secretNames.length<2) return alert("Add at least 2 names");
 addNames.classList.add("hidden");
 saveTitle.classList.remove("hidden");
}
function saveSet(){
 const t=setTitle.value.trim();
 if(!t) return alert("Enter title");
 loadSets(); sets[t]=[...secretNames]; saveSets();
 startGame();
}
function skipSave(){ startGame(); }

/* ---------- SAVED LIST ---------- */
function renderSaved(){
 savedSets.innerHTML="";
 Object.keys(sets).forEach(t=>{
  savedSets.innerHTML+=`
   <div class="list-item">
    <span>${t}</span>
    <button class="primary" onclick="selectSet('${t}')">Use</button>
    <button class="red" onclick="deleteSet('${t}')">‚úï</button>
   </div>`;
 });
}
function selectSet(t){
 secretNames=[...sets[t]];
 startGame();
}
function deleteSet(t){
 if(confirm("Delete this set?")){
  delete sets[t];saveSets();renderSaved();
 }
}
function backToStart(){
 savedList.classList.add("hidden");
 startChoice.classList.remove("hidden");
}

/* ---------- GAME ---------- */
function startGame(){
 startChoice.classList.add("hidden");
 addNames.classList.add("hidden");
 saveTitle.classList.add("hidden");
 savedList.classList.add("hidden");
 roundEnd.classList.add("hidden");

 assignments=[];
 currentPlayer=0;

 pickAssignments();
 game.classList.remove("hidden");
 updateCard();
}

function pickAssignments(){
 assignments=[];
 let imposterIndexes=[];

 while(imposterIndexes.length < imposterTotal){
  let r=Math.floor(Math.random()*players.length);
  if(!imposterIndexes.includes(r) && r!==lastMainImposter){
   imposterIndexes.push(r);
  }
 }

 lastMainImposter = imposterIndexes[0];

 const secret=secretNames[Math.floor(Math.random()*secretNames.length)];

 players.forEach((_,i)=>{
  assignments.push(imposterIndexes.includes(i) ? "You are the Imposter" : secret);
 });
}

function updateCard(){
  playerTitle.innerText = players[currentPlayer];
  infoText.classList.remove("hidden");

  nameText.classList.add("hidden");
  nameText.classList.remove("imposter");
  nameText.innerText = "";

  revealBtn.classList.remove("hidden");
  nextBtn.classList.add("hidden");
}

function reveal(){
  nameText.innerText = assignments[currentPlayer];

  if(assignments[currentPlayer] === "You are the Imposter"){
    nameText.classList.add("imposter");
  } else {
    nameText.classList.remove("imposter");
  }

  nameText.classList.remove("hidden");
  infoText.classList.add("hidden");

  revealBtn.classList.add("hidden");
  nextBtn.classList.remove("hidden");
}

function nextPlayer(){
 currentPlayer++;
 if(currentPlayer>=players.length){
  endRound();
 }else updateCard();
}

function endRound(){
 game.classList.add("hidden");
 roundEnd.classList.remove("hidden");
}

function nextRound(){
 round++;
 roundCounter.innerText="Round: "+round;
 assignments=[];
 currentPlayer=0;
 roundEnd.classList.add("hidden");
 pickAssignments();
 game.classList.remove("hidden");
 updateCard();
}
</script>
</body>
</html>
